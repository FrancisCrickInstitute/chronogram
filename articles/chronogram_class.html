<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introducing the chronogram class • chronogram</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introducing the chronogram class">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chronogram</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/chronogram.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Assembly</h6></li>
    <li><a class="dropdown-item" href="../articles/assembly.html">Chronogram assembly</a></li>
    <li><a class="dropdown-item" href="../articles/SQL_assembly.html">Assembly from SQL</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Annotation</h6></li>
    <li><a class="dropdown-item" href="../articles/annotate_vaccines.html">Annotate vaccines</a></li>
    <li><a class="dropdown-item" href="../articles/annotate_episodes.html">Annotate infection episodes</a></li>
    <li><a class="dropdown-item" href="../articles/annotate_exposure.html">Annotate exposures</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/stats.html">Chronogram statistics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Chronogram class</h6></li>
    <li><a class="dropdown-item" href="../articles/chronogram_class.html">Introducing the chronogram class</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introducing the chronogram class</h1>
            
      

      <div class="d-none name"><code>chronogram_class.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-chronogram-class">The chronogram class<a class="anchor" aria-label="anchor" href="#the-chronogram-class"></a>
</h2>
<p>The chronogram class extends <a href="https://tibble.tidyverse.org/articles/extending.html" title="tidyverse guide to extend tibble" class="external-link">tibble</a> and <a href="https://dplyr.tidyverse.org/reference/dplyr_extending.html" title="tidyverse guide to extend dplyr" class="external-link">dplyr</a>. The chronogram
class:</p>
<ul>
<li><p>asserts that each combination of date and participant ID can only
be a single row.</p></li>
<li><p>uses attributes slots to store the names of columns containing
the index dates, participant IDs, and metadata columns. The chronogram
package provides these column names to other chronogram
functions.</p></li>
<li><p>uses the `pillar` package to customise the printing of a
chronogram</p></li>
<li><p>has a related grouped chronogram class, which allows group_by()
and subsequent tidyverse verbs to work as you would expect.</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://franciscrickinstitute.github.io/chronogram/">chronogram</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'lubridate'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     date, intersect, setdiff, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="differences-between-chronogram-and-tibble-classes">Differences between chronogram and tibble classes<a class="anchor" aria-label="anchor" href="#differences-between-chronogram-and-tibble-classes"></a>
</h2>
<p>We will use a simple example dataset to illustrate these
differences.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## a 3m window for this particular chronogram ##</span></span>
<span><span class="va">start_date</span> <span class="op">&lt;-</span> <span class="st">"01012020"</span></span>
<span><span class="va">end_date</span> <span class="op">&lt;-</span> <span class="st">"01042020"</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## load example metadata ##</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"smallstudy"</span><span class="op">)</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="va">smallstudy</span><span class="op">$</span><span class="va">small_study_metadata</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">elig_study_id</th>
<th align="right">age</th>
<th align="left">sex</th>
<th align="left">dose_1</th>
<th align="left">date_dose_1</th>
<th align="left">dose_2</th>
<th align="left">date_dose_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">40</td>
<td align="left">F</td>
<td align="left">AZD1222</td>
<td align="left">2021-01-05</td>
<td align="left">AZD1222</td>
<td align="left">2021-02-05</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">45</td>
<td align="left">F</td>
<td align="left">BNT162b2</td>
<td align="left">2021-01-05</td>
<td align="left">BNT162b2</td>
<td align="left">2021-02-05</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">35</td>
<td align="left">M</td>
<td align="left">BNT162b2</td>
<td align="left">2021-01-10</td>
<td align="left">BNT162b2</td>
<td align="left">2021-03-10</td>
</tr>
</tbody>
</table>
<p>We next create a chronogram (class chronogram), and a chronogram-like
object (class tibble).</p>
<p>Using the chronogram assembly:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cg</span> <span class="op">&lt;-</span> <span class="fu">chronogram</span><span class="fu">::</span><span class="fu"><a href="../reference/cg_assemble.html">cg_assemble</a></span><span class="op">(</span></span>
<span>  start_date <span class="op">=</span> <span class="va">start_date</span>,</span>
<span>  end_date <span class="op">=</span> <span class="va">end_date</span>,</span>
<span>  metadata <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>  metadata_ids_col <span class="op">=</span> <span class="va">elig_study_id</span>,</span>
<span>  calendar_date_col <span class="op">=</span> <span class="va">calendar_date</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking input parameters...</span></span>
<span><span class="co">#&gt; -- checking start date 01012020</span></span>
<span><span class="co">#&gt; -- checking end date 01042020</span></span>
<span><span class="co">#&gt; -- checking end date later than start date</span></span>
<span><span class="co">#&gt; -- checking metadata</span></span>
<span><span class="co">#&gt; --no experiment data provided. Add later: cg_add_experiment()</span></span>
<span><span class="co">#&gt; Input checks completed</span></span>
<span><span class="co">#&gt; Chronogram assembling...</span></span>
<span><span class="co">#&gt; -- chrongram_skeleton built</span></span>
<span><span class="co">#&gt; -- chrongram built with metadata</span></span>
<span><span class="co">#&gt; -- no experiment data provided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Assembly finished</span></span>
<span></span>
<span><span class="va">cg</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble:     276 × 8</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A chronogram: </span><span style="color: #0000BB;">try summary()</span></span></span>
<span><span class="co">#&gt;    calendar_date elig_study_id   age sex   dose_1 date_dose_1 dose_2 date_dose_2</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2020-01-01    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2020-01-02    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2020-01-03    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2020-01-04    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2020-01-05    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2020-01-06    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2020-01-07    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2020-01-08    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2020-01-09    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2020-01-10    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 266 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># </span><span style="color: #BBBB00;">★</span> <span style="color: #BBBB00;">Dates:</span> calendar_date      <span style="color: #BBBB00;">★</span> <span style="color: #BBBB00;">IDs:</span> elig_study_id</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># </span><span style="color: #BBBB00;">★</span> <span style="color: #BBBB00;">metadata:</span> age, sex, dose_1, date_dose_1, dose_2, date_dose_2</span></span></code></pre></div>
<p>Using tibble-based assembly:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cg_tibble</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span></span>
<span>    calendar_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span></span>
<span>      <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">dmy</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span>,</span>
<span>      <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">dmy</a></span><span class="op">(</span><span class="va">end_date</span><span class="op">)</span>,</span>
<span>      by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    elig_study_id <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">elig_study_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(elig_study_id)`</span></span>
<span></span>
<span><span class="va">cg_tibble</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 276 × 8</span></span></span>
<span><span class="co">#&gt;    calendar_date elig_study_id   age sex   dose_1 date_dose_1 dose_2 date_dose_2</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2020-01-01                1    40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2020-01-01                2    45 F     BNT16… 2021-01-05  BNT16… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2020-01-01                3    35 M     BNT16… 2021-01-10  BNT16… 2021-03-10 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2020-01-02                1    40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2020-01-02                2    45 F     BNT16… 2021-01-05  BNT16… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2020-01-02                3    35 M     BNT16… 2021-01-10  BNT16… 2021-03-10 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2020-01-03                1    40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2020-01-03                2    45 F     BNT16… 2021-01-05  BNT16… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2020-01-03                3    35 M     BNT16… 2021-01-10  BNT16… 2021-03-10 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2020-01-04                1    40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 266 more rows</span></span></span></code></pre></div>
<p>Whilst these classes are different, the containing data is identical,
once arranged equivalently:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span></span>
<span>  <span class="va">cg_tibble</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">elig_study_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">calendar_date</span>, .by_group <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span></span>
<span>  </span>
<span>    <span class="va">cg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Although the setup code feels very similar to either approach, the
chronogram class checks the input data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create example metadata, with a duplicated row ##</span></span>
<span><span class="va">metadata_duplicated_row</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>    <span class="va">metadata</span>, </span>
<span>            <span class="va">metadata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_tail</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">metadata_duplicated_row</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">elig_study_id</th>
<th align="right">age</th>
<th align="left">sex</th>
<th align="left">dose_1</th>
<th align="left">date_dose_1</th>
<th align="left">dose_2</th>
<th align="left">date_dose_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">40</td>
<td align="left">F</td>
<td align="left">AZD1222</td>
<td align="left">2021-01-05</td>
<td align="left">AZD1222</td>
<td align="left">2021-02-05</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">45</td>
<td align="left">F</td>
<td align="left">BNT162b2</td>
<td align="left">2021-01-05</td>
<td align="left">BNT162b2</td>
<td align="left">2021-02-05</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">35</td>
<td align="left">M</td>
<td align="left">BNT162b2</td>
<td align="left">2021-01-10</td>
<td align="left">BNT162b2</td>
<td align="left">2021-03-10</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">35</td>
<td align="left">M</td>
<td align="left">BNT162b2</td>
<td align="left">2021-01-10</td>
<td align="left">BNT162b2</td>
<td align="left">2021-03-10</td>
</tr>
</tbody>
</table>
<p>Using the chronogram assembly:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cg_fail</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span>
<span>  <span class="fu">chronogram</span><span class="fu">::</span><span class="fu"><a href="../reference/cg_assemble.html">cg_assemble</a></span><span class="op">(</span></span>
<span>  start_date <span class="op">=</span> <span class="va">start_date</span>,</span>
<span>  end_date <span class="op">=</span> <span class="va">end_date</span>,</span>
<span>  <span class="co">## use the new metadata ##</span></span>
<span>  metadata <span class="op">=</span> <span class="va">metadata_duplicated_row</span>,</span>
<span>  metadata_ids_col <span class="op">=</span> <span class="va">elig_study_id</span>,</span>
<span>  calendar_date_col <span class="op">=</span> <span class="va">calendar_date</span></span>
<span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking input parameters...</span></span>
<span><span class="co">#&gt; -- checking start date 01012020</span></span>
<span><span class="co">#&gt; -- checking end date 01042020</span></span>
<span><span class="co">#&gt; -- checking end date later than start date</span></span>
<span><span class="co">#&gt; -- checking metadata</span></span>
<span><span class="co">#&gt; --no experiment data provided. Add later: cg_add_experiment()</span></span>
<span><span class="co">#&gt; Input checks completed</span></span>
<span><span class="co">#&gt; Chronogram assembling...</span></span>
<span><span class="co">#&gt; Warning in chronogram_skeleton(start_date = start_date, end_date = end_date, : Duplicate IDs found :  3 Check your input ID vector...</span></span>
<span><span class="co">#&gt;       provide a unique identifier for</span></span>
<span><span class="co">#&gt;       each individual</span></span>
<span><span class="co">#&gt; Returning a de-duplicated chronogram_skeleton...</span></span>
<span><span class="co">#&gt; -- chrongram_skeleton built</span></span>
<span><span class="co">#&gt; Error in check_metadata(x = metadata, cg_skeleton = cg_skeleton) : </span></span>
<span><span class="co">#&gt;   { .... is not TRUE</span></span>
<span></span>
<span><span class="va">cg_fail</span></span>
<span><span class="co">#&gt; [1] "Error in check_metadata(x = metadata, cg_skeleton = cg_skeleton) : \n  { .... is not TRUE\n"</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "try-error"</span></span>
<span><span class="co">#&gt; attr(,"condition")</span></span>
<span><span class="co">#&gt; &lt;simpleError in check_metadata(x = metadata, cg_skeleton = cg_skeleton): { .... is not TRUE&gt;</span></span></code></pre></div>
<p>Using tibble-based assembly:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cg_tibble</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span></span>
<span>    calendar_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span></span>
<span>      <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">dmy</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span>,</span>
<span>      <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">dmy</a></span><span class="op">(</span><span class="va">end_date</span><span class="op">)</span>,</span>
<span>      by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    elig_study_id <span class="op">=</span> <span class="va">metadata_duplicated_row</span><span class="op">$</span><span class="va">elig_study_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">metadata_duplicated_row</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(elig_study_id)`</span></span>
<span><span class="co">#&gt; Warning in left_join(., metadata_duplicated_row): Detected an unexpected many-to-many relationship between `x` and `y`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Row 3 of `x` matches multiple rows in `y`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Row 1 of `y` matches multiple rows in `x`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> If a many-to-many relationship is expected, set `relationship =</span></span>
<span><span class="co">#&gt;   "many-to-many"` to silence this warning.</span></span>
<span></span>
<span><span class="va">cg_tibble</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 368 × 8</span></span></span>
<span><span class="co">#&gt;    calendar_date elig_study_id   age sex   dose_1 date_dose_1 dose_2 date_dose_2</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2020-01-01                1    40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2020-01-01                2    45 F     BNT16… 2021-01-05  BNT16… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2020-01-01                3    35 M     BNT16… 2021-01-10  BNT16… 2021-03-10 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2020-01-01                3    35 M     BNT16… 2021-01-10  BNT16… 2021-03-10 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2020-01-02                1    40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2020-01-02                2    45 F     BNT16… 2021-01-05  BNT16… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2020-01-02                3    35 M     BNT16… 2021-01-10  BNT16… 2021-03-10 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2020-01-02                3    35 M     BNT16… 2021-01-10  BNT16… 2021-03-10 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2020-01-03                1    40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2020-01-03                2    45 F     BNT16… 2021-01-05  BNT16… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 358 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="validating-a-chronogram">Validating a chronogram<a class="anchor" aria-label="anchor" href="#validating-a-chronogram"></a>
</h2>
<p><code><a href="../reference/validate_chronogram.html">chronogram::validate_chronogram()</a></code> can be used to check a
chronogram is correct.</p>
<p>The tibble version expectedly fails:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/validate_chronogram.html">validate_chronogram</a></span><span class="op">(</span><span class="va">cg_tibble</span><span class="op">)</span> <span class="co">## fails</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in validate_chronogram(cg_tibble) : </span></span>
<span><span class="co">#&gt;   Invalid chronogram: Wrong class. Create with 'chronogram()'</span></span>
<span></span>
<span><span class="fu"><a href="../reference/validate_chronogram.html">validate_chronogram</a></span><span class="op">(</span><span class="va">cg</span><span class="op">)</span> <span class="co">## returns TRUE</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We can intentionally break the row “rule” where each combination of
<code>date x participant ID</code> can appear once, or not at all.</p>
<p><strong>Example 1</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## break "rule" one way ##------------------------------------------------------------</span></span>
<span><span class="va">not_a_cg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">cg</span>, </span>
<span>                      <span class="va">cg</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/validate_chronogram.html">validate_chronogram</a></span><span class="op">(</span><span class="va">not_a_cg</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in validate_chronogram(not_a_cg) : </span></span>
<span><span class="co">#&gt;   Invalid chronogram: Dates are duplicated for IDs</span></span></code></pre></div>
<p><strong>Example 2</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## break "rule" a different way ##----------------------------------------------------</span></span>
<span><span class="co">## this extra data will create 2 rows for ID==1 on 1st Jan 2020 ##</span></span>
<span><span class="va">data_to_join</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">calendar_date</span>, <span class="op">~</span><span class="va">elig_study_id</span>, <span class="op">~</span><span class="va">new_info</span>,</span>
<span>  <span class="st">"01012020"</span>,     <span class="fl">1</span>,              <span class="st">"a"</span>,</span>
<span>  <span class="st">"01012020"</span>,     <span class="fl">1</span>,              <span class="st">"b"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_to_join</span> <span class="op">&lt;-</span> <span class="va">data_to_join</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>calendar_date <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">dmy</a></span><span class="op">(</span><span class="va">calendar_date</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>elig_study_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">elig_study_id</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## using the provided method, cg_add_experiment()</span></span>
<span><span class="co">## errors, with an appropriate message</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/cg_add_experiment.html">cg_add_experiment</a></span><span class="op">(</span><span class="va">cg</span>, <span class="va">data_to_join</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in check_experiment(x = experiment, cg = cg) : </span></span>
<span><span class="co">#&gt;   Invalid experiment: date:ids are duplicated</span></span>
<span></span>
<span><span class="co">## we can use a dplyr::join ##</span></span>
<span><span class="va">still_not_a_cg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="va">data_to_join</span>, <span class="va">cg</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(calendar_date, elig_study_id)`</span></span>
<span><span class="va">still_not_a_cg_left</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">cg</span>, <span class="va">data_to_join</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(calendar_date, elig_study_id)`</span></span>
<span><span class="co">## when joining by two columns, the 1:many warning is not emitted</span></span>
<span><span class="co">## an extra row is gained:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">still_not_a_cg</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 277</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">still_not_a_cg_left</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 277</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cg</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 276</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/validate_chronogram.html">validate_chronogram</a></span><span class="op">(</span><span class="va">still_not_a_cg</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in validate_chronogram(still_not_a_cg) : </span></span>
<span><span class="co">#&gt;   Invalid chronogram: Wrong class. Create with 'chronogram()'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">still_not_a_cg</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame"</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/validate_chronogram.html">validate_chronogram</a></span><span class="op">(</span><span class="va">still_not_a_cg_left</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in validate_chronogram(still_not_a_cg_left) : </span></span>
<span><span class="co">#&gt;   Invalid chronogram: Dates are duplicated for IDs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">still_not_a_cg_left</span><span class="op">)</span> <span class="co"># left_join inherits class from first argument</span></span>
<span><span class="co">#&gt; [1] "cg_tbl"     "tbl_df"     "tbl"        "data.frame"</span></span></code></pre></div>
<p>Chronogram assembly and annotation functions use
<code><a href="../reference/validate_chronogram.html">validate_chronogram()</a></code> to maintain the row “rule” where each
combination of <code>date x participant ID</code> can be present once,
or absent.</p>
</div>
<div class="section level2">
<h2 id="chronogram-attributes">Chronogram attributes<a class="anchor" aria-label="anchor" href="#chronogram-attributes"></a>
</h2>
<p>To spare the user repetitively specifying the names used for the
columns storing participant IDs or calendar dates, these are stored as
attribute slots. These slots are examined by chronogram functions to use
the relevant columns for per-date and per-individual operations. The
user can explore these attributes:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">attribs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">cg</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## attribs is a named list:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">attribs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "list"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">attribs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "names"             "row.names"         "class"            </span></span>
<span><span class="co">#&gt; [4] "col_calendar_date" "col_ids"           "cg_pkg_version"   </span></span>
<span><span class="co">#&gt; [7] "windowed"          "cols_metadata"</span></span>
<span></span>
<span><span class="co">## print those attributes with names starting "col"</span></span>
<span><span class="va">attribs</span> <span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">attribs</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"^col"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; $col_calendar_date</span></span>
<span><span class="co">#&gt; [1] "calendar_date"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $col_ids</span></span>
<span><span class="co">#&gt; [1] "elig_study_id"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cols_metadata</span></span>
<span><span class="co">#&gt; [1] "age"         "sex"         "dose_1"      "date_dose_1" "dose_2"     </span></span>
<span><span class="co">#&gt; [6] "date_dose_2"</span></span></code></pre></div>
<p>Or, more simply:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cg</span><span class="op">)</span></span>
<span><span class="co">#&gt; A chronogram:</span></span>
<span><span class="co">#&gt;  Dates column:  calendar_date </span></span>
<span><span class="co">#&gt;  IDs column:    elig_study_id </span></span>
<span><span class="co">#&gt;  Starts on:     2020-01-01 </span></span>
<span><span class="co">#&gt;  Ends on:       2020-04-01 </span></span>
<span><span class="co">#&gt;  Contains:      3  unique participant IDs</span></span>
<span><span class="co">#&gt;  Windowed:      FALSE </span></span>
<span><span class="co">#&gt;  Spanning:      92 - 92 days [min-max per participant]</span></span>
<span><span class="co">#&gt;  Metadata:      age, sex, dose_1, date_dose_1, dose_2, date_dose_2 </span></span>
<span><span class="co">#&gt;  Size:          17.82 kB </span></span>
<span><span class="co">#&gt;  Pkg_version:   1.0.0 [used to build this cg]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cg</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble:     276 × 8</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A chronogram: </span><span style="color: #0000BB;">try summary()</span></span></span>
<span><span class="co">#&gt;    calendar_date elig_study_id   age sex   dose_1 date_dose_1 dose_2 date_dose_2</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2020-01-01    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2020-01-02    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2020-01-03    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2020-01-04    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2020-01-05    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2020-01-06    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2020-01-07    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2020-01-08    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2020-01-09    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2020-01-10    1                40 F     AZD12… 2021-01-05  AZD12… 2021-02-05 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 266 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># </span><span style="color: #BBBB00;">★</span> <span style="color: #BBBB00;">Dates:</span> calendar_date      <span style="color: #BBBB00;">★</span> <span style="color: #BBBB00;">IDs:</span> elig_study_id</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># </span><span style="color: #BBBB00;">★</span> <span style="color: #BBBB00;">metadata:</span> age, sex, dose_1, date_dose_1, dose_2, date_dose_2</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">cg</span><span class="op">)</span> <span class="co">## no experiment data added to this chronogram</span></span>
<span><span class="co">#&gt; Glimpse: chronogram </span></span>
<span><span class="co">#&gt;  Dates column:  calendar_date </span></span>
<span><span class="co">#&gt;  IDs column:    elig_study_id </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metadata</span></span>
<span><span class="co">#&gt; Rows: 276</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; $ age         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40…</span></span>
<span><span class="co">#&gt; $ sex         <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F…</span></span>
<span><span class="co">#&gt; $ dose_1      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> AZD1222, AZD1222, AZD1222, AZD1222, AZD1222, AZD1222, AZD1…</span></span>
<span><span class="co">#&gt; $ date_dose_1 <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2021-01-05, 2021-01-05, 2021-01-05, 2021-01-05, 2021-01-0…</span></span>
<span><span class="co">#&gt; $ dose_2      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> AZD1222, AZD1222, AZD1222, AZD1222, AZD1222, AZD1222, AZD1…</span></span>
<span><span class="co">#&gt; $ date_dose_2 <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2021-02-05, 2021-02-05, 2021-02-05, 2021-02-05, 2021-02-0…</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Experiment data &amp; annotations</span></span>
<span><span class="co">#&gt; Rows: 276</span></span>
<span><span class="co">#&gt; Columns: 0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Chronogram is a subclass of tibble, and allows additional checks on
its validity. We found that assemblying data such that rows were present
for each <code>{ID x date}</code> combination by sequential joins is
prone to duplicating rows. During <code>chronogram</code> development,
we opted to assert the condition that each is <code>{ID x date}</code>
combination could be present once, or absent. As we wanted to avoid
altering handling of “conventional” tibble, we extended as a
sub-class.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward Carr, David Greenwood, Marianne Shawe-Taylor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
